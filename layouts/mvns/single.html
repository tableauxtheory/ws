{{ define "main" }}
  <div class="flex flex-col gap-8">
    <div class="flex-1">
      <h1 class="py-2">{{ .Title }}</h1>

      {{ with .Params.image }}
        {{- $src := . -}}
        {{- $srcBase := index (split (index (split $src "?") 0) "#") 0 -}}
        {{- $staticPath := printf "static/%s" (strings.TrimPrefix "/" $srcBase) -}}
        {{- if fileExists $staticPath -}}
          {{- $src = printf "%s?v=%s" $srcBase (md5 (readFile $staticPath)) -}}
        {{- end -}}
        <img src="{{ $src }}" alt="" class="pixelated pixel-frame w-full h-auto rounded-md mb-6">
      {{ end }}

      {{ with .Params.store }}
        <div class="not-prose flex flex-row flex-wrap justify-center gap-6 mb-6">
          {{ with .steam }}<a class="store-link" href="{{ . }}" target="_blank" rel="noopener noreferrer">steam</a>{{ end }}
          {{ with .gog }}<a class="store-link" href="{{ . }}" target="_blank" rel="noopener noreferrer">gog</a>{{ end }}
          {{ with .itch }}<a class="store-link" href="{{ . }}" target="_blank" rel="noopener noreferrer">itch.io</a>{{ end }}
          {{ with .kickstarter }}<a class="store-link" href="{{ . }}" target="_blank" rel="noopener noreferrer">kickstarter</a>{{ end }}
        </div>
      {{ end }}

      {{ .Content }}
    </div>
  </div>
{{ end }}
